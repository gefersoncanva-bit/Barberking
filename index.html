<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Barberking - Agendamento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: { sans: ['Outfit', 'sans-serif'] },
            colors: {
              gold: { 400: '#fbbf24', 500: '#f59e0b', 600: '#d97706' },
              dark: { 800: '#1f2937', 900: '#111827', 950: '#030712' }
            }
          }
        }
      }
    </script>
    <style>
        body { background-color: #030712; color: #f3f4f6; }
        .glass { background: rgba(17, 24, 39, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .btn-gold { background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%); transition: all 0.3s ease; }
        .btn-gold:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(217, 119, 6, 0.4); }
    </style>
</head>
<body class="min-h-screen pb-12">
    <header class="py-8 text-center border-b border-white/5 mb-8">
        <h1 class="text-4xl font-bold tracking-tighter text-white">BARBER<span class="text-gold-500">KING</span></h1>
        <p class="text-gray-400 mt-2 uppercase tracking-widest text-xs">Agendamento Online</p>
    </header>

    <main class="max-w-4xl mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="space-y-6">
                <section class="glass p-6 rounded-2xl">
                    <h2 class="text-xl font-semibold mb-6 text-gold-500">1. ServiÃ§o</h2>
                    <div id="services-grid" class="grid grid-cols-1 gap-3"></div>
                </section>
                <section class="glass p-6 rounded-2xl">
                    <h2 class="text-xl font-semibold mb-6 text-gold-500">2. Profissional</h2>
                    <div id="barbers-grid" class="grid grid-cols-2 gap-3"></div>
                </section>
                <section class="glass p-6 rounded-2xl">
                    <h2 class="text-xl font-semibold mb-6 text-gold-500">3. Data e Hora</h2>
                    <input type="date" id="booking-date" class="w-full bg-dark-900 border border-white/10 rounded-xl p-4 text-white outline-none mb-6">
                    <div id="slots-grid" class="grid grid-cols-3 gap-2"></div>
                </section>
            </div>

            <div class="relative">
                <div class="glass p-8 rounded-2xl sticky top-8">
                    <h2 class="text-2xl font-bold mb-6 text-white text-center">Resumo</h2>
                    <div id="summary-content" class="space-y-4 mb-8"></div>
                    <div id="client-info" class="hidden space-y-4">
                        <input type="text" id="client-name" placeholder="Seu Nome" class="w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white">
                        <input type="tel" id="client-phone" placeholder="Seu WhatsApp" class="w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white">
                        <div class="flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/10">
                            <input type="checkbox" id="wants-reminder" checked class="w-5 h-5 accent-gold-500">
                            <label for="wants-reminder" class="text-sm text-gray-300 italic">Ativar lembrete (30 min antes)</label>
                        </div>
                        <button id="btn-confirm" onclick="confirmBooking()" class="btn-gold w-full py-4 rounded-xl text-dark-950 font-bold uppercase">Confirmar Agendamento</button>
                        <div id="success-area" class="hidden space-y-3">
                            <p class="text-green-400 text-center font-bold">âœ“ Agendado com sucesso!</p>
                            <div id="reminder-box" class="hidden">
                                <a id="calendar-reminder" target="_blank" class="flex items-center justify-center w-full py-3 rounded-xl bg-blue-600 text-white font-bold text-sm">ðŸ”” Salvar na Agenda</a>
                            </div>
                            <button onclick="location.reload()" class="w-full text-xs text-gray-400 underline">Novo Agendamento</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const STORAGE_KEY = 'barber_appointments';
        const OFF_STORAGE_KEY = 'barber_off_dates';
        const SHOP_HOURS = { 0: {start: 9, end: 18}, 1: {start:9, end:18}, 2: {start:9, end:18}, 3: {start:9, end:18}, 4: {start:9, end:18}, 5: {start:9, end:18}, 6: {start:8, end:18} };
        const SERVICES = [
            { id: 'corte', name: 'Corte de Cabelo', price: 35, icon: 'âœ‚ï¸' },
            { id: 'barba', name: 'Barba Terapia', price: 30, icon: 'ðŸª’' },
            { id: 'Pezinho', name: 'Acabamento/Pezinho', price: 25, icon: 'ðŸ“' },
            { id: 'combo', name: 'Combo Completo', price: 50, icon: 'ðŸ‘‘' }
        ];
        const BARBERS = [
            { id: 'Chiquinho', name: 'Chiquinho' }, { id: 'Mayco', name: 'Mayco' }, { id: 'Erick', name: 'Erick' }
        ];

        let bookingState = { serviceId: null, professionalId: null, date: '', time: null };

        function init() {
            renderServices(); renderBarbers();
            const dateInput = document.getElementById('booking-date');
            dateInput.min = new Date().toISOString().split('T')[0];
            dateInput.addEventListener('change', (e) => {
                const dateObj = new Date(e.target.value + 'T00:00:00');
                if (SHOP_HOURS[dateObj.getDay()] === null) { alert('Fechado neste dia.'); e.target.value = ''; return; }
                bookingState.date = e.target.value; bookingState.time = null;
                renderTimeSlots(); updateFormVisibility();
            });
        }

        function renderServices() {
            document.getElementById('services-grid').innerHTML = SERVICES.map(s => `
                <button onclick="selectService('${s.id}')" id="svc-${s.id}" class="flex items-center justify-between p-4 rounded-xl border border-white/10 bg-white/5">
                    <span>${s.icon} ${s.name}</span><span class="text-gold-500 font-bold">R$ ${s.price}</span>
                </button>`).join('');
        }

        function renderBarbers() {
            document.getElementById('barbers-grid').innerHTML = BARBERS.map(b => `
                <button onclick="selectBarber('${b.id}')" id="brb-${b.id}" class="p-4 rounded-xl border border-white/10 bg-white/5 text-center font-semibold">${b.name}</button>`).join('');
        }

        function renderTimeSlots() {
            if (!bookingState.date || !bookingState.professionalId) return;
            const container = document.getElementById('slots-grid');
            const apps = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            const offDates = JSON.parse(localStorage.getItem(OFF_STORAGE_KEY) || '[]');
            const config = SHOP_HOURS[new Date(bookingState.date + 'T00:00:00').getDay()];
            
            let slots = [];
            for(let h = config.start; h < config.end; h++) {
                if(h >= 12 && h < 14) continue;
                [`${h}:00`, `${h}:30`].forEach(t => {
                    const time = t.padStart(5, '0');
                    const isTaken = apps.some(a => a.date === bookingState.date && a.time === time && a.professionalId === bookingState.professionalId);
                    const isBlocked = offDates.some(b => b.date === bookingState.date && (b.barber === 'all' || b.barber === bookingState.professionalId) && (!b.start || (time >= b.start && time < b.end)));
                    if(!isBlocked) slots.push({time, isTaken});
                });
            }
            container.innerHTML = slots.map(s => `<button ${s.isTaken ? 'disabled' : `onclick="selectTime('${s.time}')"`} class="p-3 rounded-lg text-sm ${s.isTaken ? 'opacity-20 bg-red-900' : bookingState.time === s.time ? 'bg-gold-500 text-black' : 'bg-white/5 border border-white/10'}">${s.time}</button>`).join('');
        }

        function selectService(id) { 
            bookingState.serviceId = id; 
            SERVICES.forEach(s => document.getElementById(`svc-${s.id}`).className = s.id === id ? 'flex items-center justify-between p-4 rounded-xl border border-gold-500 bg-gold-500/20' : 'flex items-center justify-between p-4 rounded-xl border border-white/10 bg-white/5');
            updateFormVisibility(); 
        }

        function selectBarber(id) { 
            bookingState.professionalId = id; 
            BARBERS.forEach(b => document.getElementById(`brb-${b.id}`).className = b.id === id ? 'p-4 rounded-xl border border-gold-500 bg-gold-500/20 text-center font-semibold' : 'p-4 rounded-xl border border-white/10 bg-white/5 text-center font-semibold');
            renderTimeSlots(); updateFormVisibility(); 
        }

        function selectTime(time) { bookingState.time = time; renderTimeSlots(); updateFormVisibility(); }

        function updateFormVisibility() {
            const summary = document.getElementById('summary-content');
            if (bookingState.serviceId && bookingState.professionalId && bookingState.date && bookingState.time) {
                const service = SERVICES.find(s => s.id === bookingState.serviceId);
                summary.innerHTML = `<div class="p-4 border border-gold-500/30 rounded-lg text-sm bg-white/5"><p class="font-bold text-gold-500 mb-2">Resumo da Reserva</p><p>Data: ${bookingState.date.split('-').reverse().join('/')}</p><p>Hora: ${bookingState.time}</p><p>ServiÃ§o: ${service.name}</p></div>`;
                document.getElementById('client-info').classList.remove('hidden');
            } else { summary.innerHTML = `<p class="text-gray-500 text-center italic">Selecione os campos acima...</p>`; }
        }

        function confirmBooking() {
            const name = document.getElementById('client-name').value;
            const phone = document.getElementById('client-phone').value;
            if(!name || !phone) return alert('Preencha os dados!');
            const apps = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
            apps.push({ id: Date.now().toString(), ...bookingState, clientName: name, clientPhone: phone });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(apps));
            document.getElementById('btn-confirm').classList.add('hidden');
            document.getElementById('success-area').classList.remove('hidden');
            if(document.getElementById('wants-reminder').checked) {
                document.getElementById('calendar-reminder').href = `https://www.google.com/calendar/render?action=TEMPLATE&text=Corte+BarberKing&dates=${bookingState.date.replace(/-/g,'')}T${bookingState.time.replace(':','')}00/`;
                document.getElementById('reminder-box').classList.remove('hidden');
            }
        }
        init();
    </script>
</body>
</html>